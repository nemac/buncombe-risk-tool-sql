create table parcel_fl1yr_tab as 
select a.* FROM property as a
JOIN fl1yr as b ON st_intersects(a.geom, b.geom);

create table parcel_fl5yr_tab as 
select a.* FROM property as a
JOIN fl5yr as b ON st_intersects(a.geom, b.geom);

create table building_parcel_fl1yr_tab as 
select a.* FROM building_footprints as a
JOIN fl1yr as b ON st_intersects(a.geom, b.geom);

create table building_fl5yr_tab as 
select a.* FROM building_footprints as a
JOIN fl5yr as b ON st_intersects(a.geom, b.geom);

alter table parcel_fl1yr_tab
add column bldg_flood_yn text

alter table parcel_fl1yr_tab 
drop column bldg_flood_yn

update parcel_fl1yr_tab as a
set bldg_flood_yn = (select case when a.pin = b.pin then 'yes' else 
'no' end) from building_fl1yr_tab as b

alter table parcel_fl5yr_tab 
add column YN_bldg_flood text

alter table build_fl5yr_tab 
add column YN_bldg_flood text

update parcel_fl5yr_tab as a
set yes_no = (select case when a.pinnum = b.pinnum then 'yes' else 
'no' end) from building_fl1yr_tab as b
